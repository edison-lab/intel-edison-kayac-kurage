'use strict'

/*
--------------------------------------------------------------------------------
    Module
--------------------------------------------------------------------------------
*/
var mraa  = require('mraa')
  ;

/*
--------------------------------------------------------------------------------
    Constant
--------------------------------------------------------------------------------
*/
var ADDRESS   = 0x64;
var MAX_VALUE = 40;

/*
--------------------------------------------------------------------------------
    Variable
--------------------------------------------------------------------------------
*/
var driver
  , command
  ;

driver = new mraa.I2c(0);
driver.address(ADDRESS);

command = new Buffer(2);
command[0] = 0x00;
command[1] = 0x00;

/*
--------------------------------------------------------------------------------
    Public
--------------------------------------------------------------------------------
*/
/**
 * Motor control.
 * @param {number} Power. Controlled by the integer and negative.
 */
module.exports.update = function(val)
{
    var direc = 0;

    if (val > 0)
    {
        direc = 1;
    }
    else if (val < 0)
    {
        direc = 2;
        val *= -1;
    }

    if (val > MAX_VALUE)
    {
        val = MAX_VALUE;
    }

    command[1] = val << 2 | direc;
    driver.write(command);
}

/*
--------------------------------------------------------------------------------
    Private
--------------------------------------------------------------------------------
*/

